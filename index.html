<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Classroom Basketball</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
</head>
<body>
<script>
let player, bot, ball;
let keys = {};

let target = {x:720, y:200, w:20, h:50}; // trash can hoop

function setup() {
  createCanvas(800, 400);
  player = new Character(100, 300);
  bot = new Character(500, 300, true);
  ball = new Ball(120, 300);
}

function draw() {
  background(230);

  drawClassroom();

  player.update();
  player.show();

  bot.update();
  bot.show();

  ball.update();
  ball.show();

  // --- AUTO AIM SCORING ---
  if (
    !ball.heldBy &&
    ball.x > target.x &&
    ball.x < target.x + target.w &&
    ball.y > target.y &&
    ball.y < target.y + target.h
  ) {
    if (ball.lastHolder) {
      ball.lastHolder.points++;
    }
    resetBall();
  }

  // Scoreboard
  fill(0);
  textSize(20);
  textAlign(CENTER);
  text(player.points + " - " + bot.points, width/2, 30);
}

// --- CLASSES ---
class Character {
  constructor(x, y, isBot=false) {
    this.x = x;
    this.y = y;
    this.w = 40;
    this.h = 80;
    this.vx = 0;
    this.vy = 0;
    this.onGround = true;
    this.isBot = isBot;
    this.points = 0;
    this.withBall = false;
  }

  update() {
    if (!this.isBot) {
      if (keys["ArrowLeft"] || keys["a"]) this.vx = -3;
      else if (keys["ArrowRight"] || keys["d"]) this.vx = 3;
      else this.vx = 0;

      if ((keys["ArrowUp"] || keys["w"] || keys[" "]) && this.onGround) {
        this.vy = -8;
        this.onGround = false;
      }
    } else {
      if (!this.withBall) {
        if (ball.x < this.x) this.vx = -2;
        else this.vx = 2;
      } else {
        if (random(1) < 0.01) {
          ball.throw(this);
          this.withBall = false;
        }
      }
    }

    this.x += this.vx;
    this.y += this.vy;
    this.vy += 0.5;

    if (this.y >= 300) {
      this.y = 300;
      this.vy = 0;
      this.onGround = true;
    }

    // auto-get ball
    if (dist(this.x, this.y, ball.x, ball.y) < 30 && !ball.heldBy) {
      this.withBall = true;
      ball.heldBy = this;
    }
  }

  show() {
    fill(this.isBot ? "red" : "blue");
    rect(this.x-20, this.y-60, this.w, this.h);
  }
}

class Ball {
  constructor(x, y) {
    this.x = x;
    this.y = y;
    this.vx = 0;
    this.vy = 0;
    this.heldBy = null;
    this.lastHolder = null;
  }

  update() {
    if (this.heldBy) {
      this.x = this.heldBy.x;
      this.y = this.heldBy.y - 30;
      this.lastHolder = this.heldBy;
    } else {
      this.x += this.vx;
      this.y += this.vy;
      this.vy += 0.4;
      if (this.y > 310) {
        this.y = 310;
        this.vy = 0;
      }

      // prevent ball from being stuck past trash can
      if (this.x > width) {
        this.x = width - 20;
        this.vx = -this.vx * 0.5;
      }
    }
  }

  throw(holder) {
    this.heldBy = null;
    this.x = holder.x;
    this.y = holder.y - 30;
    this.vx = 5;
    this.vy = -6;
    this.lastHolder = holder;
  }

  show() {
    fill(200);
    ellipse(this.x, this.y, 15, 15);
  }
}

function resetBall() {
  ball = new Ball(width/2, 300);
}

function drawClassroom() {
  fill(180);
  rect(700, 250, 60, 100); // table
  fill(100);
  rect(target.x, target.y, target.w, target.h); // trash can
}

function keyPressed() { keys[key] = true; }
function keyReleased() { keys[key] = false; }
</script>
</body>
</html>
