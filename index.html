<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Classroom Basketball</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
</head>
<body>
<script>
let player, bot, ball;
let keys = {};
let target; // trash can

function setup() {
  createCanvas(800, 400);

  player = new Character(100, 300, "blue");
  bot = new Character(500, 300, "red", true);
  ball = new Ball(120, 300);

  // Trash can target area
  target = {x: 720, y: 200, w: 20, h: 50};
}

function draw() {
  background(230);

  // Classroom background
  drawClassroom();

  // Update characters
  player.update();
  player.show();

  bot.update();
  bot.show();

  // Update ball
  ball.update();
  ball.show();

  // Scoring check
  if (
    ball.x > target.x &&
    ball.x < target.x + target.w &&
    ball.y > target.y &&
    ball.y < target.y + target.h
  ) {
    if (ball.lastHolder) {
      ball.lastHolder.points++;
    }
    resetBall();
  }

  // Scoreboard
  fill(0);
  textSize(20);
  textAlign(CENTER);
  text(player.points + " - " + bot.points, width/2, 30);
}

class Character {
  constructor(x, y, color, isBot=false) {
    this.x = x;
    this.y = y;
    this.w = 40;
    this.h = 80;
    this.vx = 0;
    this.vy = 0;
    this.onGround = true;
    this.color = color;
    this.withBall = false;
    this.isBot = isBot;
    this.points = 0;
  }

  update() {
    if (!this.isBot) {
      // Player controls
      if (keys["ArrowLeft"] || keys["a"]) this.vx = -3;
      else if (keys["ArrowRight"] || keys["d"]) this.vx = 3;
      else this.vx = 0;

      if ((keys["ArrowUp"] || keys["w"] || keys[" "]) && this.onGround) {
        this.vy = -8;
        this.onGround = false;
      }
    } else {
      // Bot AI
      if (!this.withBall) {
        if (ball.x < this.x) this.vx = -2;
        else this.vx = 2;
      } else {
        if (random(1) < 0.01) {
          ball.throw(this);
          this.withBall = false;
        }
      }
    }

    // Movement
    this.x += this.vx;
    this.y += this.vy;
    this.vy += 0.5; // gravity

    if (this.y >= 300) {
      this.y = 300;
      this.vy = 0;
      this.onGround = true;
    }

    // Ball pickup
    if (dist(this.x, this.y, ball.x, ball.y) < 30 && !ball.heldBy) {
      this.withBall = true;
      ball.heldBy = this;
    }
  }

  show() {
    fill(this.color);
    rect(this.x-20, this.y-60, this.w, this.h);
  }
}

class Ball {
  constructor(x, y) {
    this.x = x;
    this.y = y;
    this.vx = 0;
    this.vy = 0;
    this.heldBy = null;
    this.lastHolder = null;
  }

  update() {
    if (this.heldBy) {
      this.x = this.heldBy.x;
      this.y = this.heldBy.y - 30;
      this.lastHolder = this.heldBy;
    } else {
      this.x += this.vx;
      this.y += this.vy;
      this.vy += 0.4;
      if (this.y > 310) {
        this.y = 310;
        this.vy = 0;
      }
    }
  }

  throw(holder) {
    this.heldBy = null;
    this.x = holder.x;
    this.y = holder.y - 30;
    this.vx = 5;
    this.vy = -6;
    this.lastHolder = holder;
  }

  show() {
    fill(200);
    ellipse(this.x, this.y, 15, 15);
  }
}

function resetBall() {
  ball = new Ball(width/2, 300);
}

function drawClassroom() {
  // Desk
  fill(180);
  rect(700, 250, 60, 100);
  // Trash can (hoop)
  fill(100);
  rect(target.x, target.y, target.w, target.h);
}

function keyPressed() { keys[key] = true; }
function keyReleased() { keys[key] = false; }
</script>
</body>
</html>
