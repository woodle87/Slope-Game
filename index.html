<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Classroom Basketball</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
</head>
<body>
<script>
let player, bot, ball;
let playerImgs = {}, botImgs = {};
let keys = {};

let target = {x:720, y:200, w:20, h:50}; // trash can

function preload() {
  // Load your SVGs (must be in same folder or hosted online)
  playerImgs.idle = loadImage("costume1 (1).svg"); 
  playerImgs.run1 = loadImage("costume3.svg"); 
  playerImgs.run2 = loadImage("costume4.svg"); 
  playerImgs.shoot = loadImage("costume1 (1).svg"); // temp shooting sprite

  botImgs.idle = loadImage("costume1 (1).svg");
  botImgs.run1 = loadImage("costume3.svg");
  botImgs.run2 = loadImage("costume4.svg");
  botImgs.shoot = loadImage("costume1 (1).svg");
}

function setup() {
  createCanvas(800, 400);
  player = new Character(100, 300, playerImgs);
  bot = new Character(500, 300, botImgs, true);
  ball = new Ball(120, 300);
}

function draw() {
  background(230);

  drawClassroom();

  player.update();
  player.show();

  bot.update();
  bot.show();

  ball.update();
  ball.show();

  // SCORE CHECK (auto-score if ball enters trash can area)
  if (
    !ball.heldBy &&
    ball.x > target.x &&
    ball.x < target.x + target.w &&
    ball.y > target.y &&
    ball.y < target.y + target.h
  ) {
    if (ball.lastHolder) {
      ball.lastHolder.points++;
    }
    resetBall();
  }

  // Scoreboard
  fill(0);
  textSize(20);
  textAlign(CENTER);
  text(player.points + " - " + bot.points, width/2, 30);
}

// --- CLASSES ---
class Character {
  constructor(x, y, imgs, isBot=false) {
    this.x = x;
    this.y = y;
    this.w = 40;
    this.h = 80;
    this.vx = 0;
    this.vy = 0;
    this.onGround = true;
    this.imgs = imgs;
    this.withBall = false;
    this.isBot = isBot;
    this.points = 0;
    this.state = "idle";
  }

  update() {
    if (!this.isBot) {
      if (keys["ArrowLeft"] || keys["a"]) this.vx = -3;
      else if (keys["ArrowRight"] || keys["d"]) this.vx = 3;
      else this.vx = 0;

      if ((keys["ArrowUp"] || keys["w"] || keys[" "]) && this.onGround) {
        this.vy = -8;
        this.onGround = false;
      }
    } else {
      if (!this.withBall) {
        if (ball.x < this.x) this.vx = -2;
        else this.vx = 2;
      } else {
        if (random(1) < 0.01) {
          ball.throw(this);
          this.withBall = false;
        }
      }
    }

    this.x += this.vx;
    this.y += this.vy;
    this.vy += 0.5;

    if (this.y >= 300) {
      this.y = 300;
      this.vy = 0;
      this.onGround = true;
    }

    if (dist(this.x, this.y, ball.x, ball.y) < 30 && !ball.heldBy) {
      this.withBall = true;
      ball.heldBy = this;
    }
  }

  show() {
    let img;
    if (this.state === "shoot" && this.withBall) img = this.imgs.shoot;
    else if (this.vx !== 0) {
      img = frameCount % 20 < 10 ? this.imgs.run1 : this.imgs.run2;
    } else img = this.imgs.idle;

    image(img, this.x-20, this.y-60, this.w, this.h);
  }
}

class Ball {
  constructor(x, y) {
    this.x = x;
    this.y = y;
    this.vx = 0;
    this.vy = 0;
    this.heldBy = null;
    this.lastHolder = null;
  }

  update() {
    if (this.heldBy) {
      this.x = this.heldBy.x;
      this.y = this.heldBy.y - 30;
      this.lastHolder = this.heldBy;
    } else {
      this.x += this.vx;
      this.y += this.vy;
      this.vy += 0.4;
      if (this.y > 310) {
        this.y = 310;
        this.vy = 0;
      }
    }
  }

  throw(holder) {
    this.heldBy = null;
    this.x = holder.x;
    this.y = holder.y - 30;
    this.vx = 5;
    this.vy = -6;
    this.lastHolder = holder;
  }

  show() {
    fill(200);
    ellipse(this.x, this.y, 15, 15);
  }
}

function resetBall() {
  ball = new Ball(width/2, 300);
}

function drawClassroom() {
  fill(180);
  rect(700, 250, 60, 100); // table
  fill(100);
  rect(target.x, target.y, target.w, target.h); // trash can
}

function keyPressed() { keys[key] = true; }
function keyReleased() { keys[key] = false; }
</script>
</body>
</html>
