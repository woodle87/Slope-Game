<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Slope Clone</title>
<style>
  html, body { margin:0; padding:0; overflow:hidden; background:#87ceeb; }
  canvas { display:block; margin:0 auto; background:#87ceeb; }
</style>
</head>
<body>
<canvas id="game"></canvas>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let track = [];
let ball = { x:0, y:0, lane:1, speed:0.6 };
const lanes = 3;
const laneWidth = 100;
const trackLength = 100;
const trackHeight = 20;
const obstacles = [];
let score = 0;

// Initialize track
for(let i=0;i<trackLength;i++){
  track.push({ z:i*trackHeight });
}

// Initialize obstacles
function spawnObstacle() {
  const lane = Math.floor(Math.random()*lanes);
  const z = trackLength*trackHeight + Math.random()*500 + 200;
  obstacles.push({ lane, z });
}

// Draw green track with stripes
function drawTrack(){
  for(let i=0;i<track.length;i++){
    const t = track[i];
    const perspective = 800/(t.z+50);
    const trackW = laneWidth*lanes*perspective;
    const x = canvas.width/2 - trackW/2;
    const y = canvas.height - perspective*50 - 50;
    
    // Draw track rectangle
    ctx.fillStyle="#2ecc71";
    ctx.fillRect(x, y, trackW, perspective*trackHeight);
    
    // Draw lane stripes
    ctx.strokeStyle="#a3ffa3";
    ctx.lineWidth = 2;
    for(let l=1;l<lanes;l++){
      ctx.beginPath();
      ctx.moveTo(x+l*laneWidth*perspective, y);
      ctx.lineTo(x+l*laneWidth*perspective, y+perspective*trackHeight);
      ctx.stroke();
    }
  }
}

// Draw obstacles
function drawObstacles(){
  ctx.fillStyle="#e74c3c";
  for(let o of obstacles){
    const t = { z:o.z };
    const perspective = 800/(t.z+50);
    const trackW = laneWidth*lanes*perspective;
    const x0 = canvas.width/2 - trackW/2;
    const obsX = x0 + o.lane*laneWidth*perspective;
    const y = canvas.height - perspective*50 - 50;
    ctx.fillRect(obsX, y, laneWidth*perspective, perspective*trackHeight);
  }
}

// Draw ball
function drawBall(){
  const ballZ = 0;
  const perspective = 800/(ballZ+50);
  const trackW = laneWidth*lanes*perspective;
  const x0 = canvas.width/2 - trackW/2;
  const ballX = x0 + ball.lane*laneWidth*perspective + laneWidth*perspective/2;
  const y = canvas.height - perspective*50 - 50 - 10*perspective;
  
  ctx.beginPath();
  ctx.arc(ballX, y, 10*perspective, 0, Math.PI*2);
  ctx.fillStyle="#3498db";
  ctx.fill();
}

// Update game
function update(){
  ball.speed += 0.0005;
  score += ball.speed;
  
  // Move obstacles
  for(let o of obstacles){
    o.z -= ball.speed*20;
  }
  
  // Remove past obstacles
  while(obstacles.length && obstacles[0].z<0) obstacles.shift();
  
  // Spawn new obstacles
  if(Math.random()<0.03) spawnObstacle();
  
  // Collision detection
  for(let o of obstacles){
    if(Math.abs(o.z)<trackHeight && o.lane===ball.lane){
      alert("Game Over! Score: "+Math.floor(score));
      document.location.reload();
    }
  }
}

// Draw everything
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawTrack();
  drawObstacles();
  drawBall();
}

// Game loop
function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();

// Controls
window.addEventListener("keydown", e=>{
  if(e.key==="ArrowLeft" && ball.lane>0) ball.lane--;
  if(e.key==="ArrowRight" && ball.lane<lanes-1) ball.lane++;
});

window.addEventListener("resize", ()=>{
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});
</script>
</body>
</html>
